# 인터넷 통신

## IP(인터넷 프로토콜)

#### IP의 역할

-   지정한 IP 주소(IP Address)에 데이터 전달
-   패킷(Packet)이라는 통신 단위로 데이터 전달

#### 패킷

-   네트워크를 통해 전송되는 형식화된 데이터 덩어리
-   주요 컴포넌트로 사용자 데이터(전송 데이터, 페이로드)와 제어 정보(페이로드를 전달하기 위한 정보)가 있음

#### 패킷 헤더

-   소스와 목적지에 대한 네트워크 주소, 순서 정보, 오류 감지 코드로 구성

#### 클라이언트 패킷 전달 & 서버 패킷 전달

-   클라이언트와 서버가 서로 소통할 때 패킷을 보내면 중간에 인터넷 망을 거침
    인터넷 망을 연결하고 있는 노드들이 패킷의 헤더 있는 출발지 IP와 목적지 IP 정보를 이해하고 다른 노드로 패킷을 던지는 과정이 일어난다. 이 과정이 반복되며 데이터를 주고 받을 수 있음

#### IP 프로토콜의 한계

-   비연결성
    -   패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
-   비신뢰성
    -   중간에 패킷이 사라질 수 있음
    -   패킷이 순서대로 오지 않을 수 있음
-   프로그램 구분
    -   같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상일 때 서로를 구분할 수 없음

## TCP, UDP

#### 인터넷 프로토콜 스택의 4계층

-   애플리케이션 계층 = HTTP, FTP
-   전송 계층 = TCP, UDP
-   인터넷 계층 - IP
-   네트워크 인터페이스 계층

#### 프로토콜 계층(채팅 프로그램 예시)

1. 프로그램이 채팅 데이터 생성
2. SOCKET 라이브러리를 통해 전달
3. TCP 정보 생성, 메시지 데이터 포함
4. IP 패킷 생성, TCP 데이터 포함
5. Ethernet Frame 생성, IP 패킷 데이터 포함 - Ethernet Frame에는 랜카드에 등록된 MAC 주소 같은 물리적인 정보 포함

#### TCP/IP 패킷 정보

-   출발지 PORT
-   목적지 PORT
-   전송 제어
-   순서
-   검증 정보

#### TCP(전송 제어 프로토콜, Transmission Control Protocol) 특징

-   연결지향 - TCP 3 way handshake(가상 연결)
-   데이터 전달 보증
-   순서 보장
-   신뢰할 수 있는 프로토콜
-   현재는 대부분 TCP 사용

#### 연결지향 - TCP 3 way handshake

1. 클라이언트에서 서버로 SYN(Synchronize, 접속 요청)을 보냄. 이때 클라이언트는 SYN_SENT 상태가 됨.
2. 서버가 클라이언트의 요청을 받으면 요청을 수락한다는 ACK(Acknowledgment, 요청 수락)와 SYN 패킷을 발송하고 클라이언트가 다시 ACK로 응답할 때까지 대기함. 이때 서버는 SYN_RECEIVED 상태가 됨.
3. 클라이언트가 서버의 ACK 요청을 받으면 서버로 ACK 요청을 보내고 연결이 이루어진다. 이때 서버는 ESTABLISHED 상태가 됨.

-   ACK와 함꼐 데이터 전송 가능

#### UDP 특징(사용자 데이터그램 프로토콜, User Datagram Protocol)

-   비연결형 서비스 제공
-   헤더와 전송 데이터에 대한 체크섬 기능 제공
-   데어테에 대한 변형 오류의 검출 기능 제공 X
-   단순하고 빠름
-   애플리케이션에서 추가 작업 필요

## PORT

#### 한 번에 둘 이상 연결해야 하면?

-   클라이언트가 여러 개의 서버에 접속해서 동시에 여러 일을 처리하려고 할 때 포트로 구별해서 처리한다.
-   같은 IP 내에서 프로세스를 구분하기 위해 PORT를 사용한다.
-   IP가 한 아파트라면 PORT는 그 아파트에 있는 몇 동 몇 호를 의미한다.

#### TCP/IP 패킷 정보

-   TCP 세그먼트 헤더에 출발지 PORT, 목적지 PORT를 명시하여 요청을 구별한다.

#### PORT 할당 가능한 범위

-   0 ~ 65535: 할당 가능
-   0 ~ 1023: 잘 알려진 포트(Well-Known Port), 사용하지 않는 것이 좋음
    -   FTP: 20, 21
    -   TELNET: 23
    -   HTTP: 80
    -   HTTPS: 443

## DNS

#### DNS를 사용하는 이유

-   IP 주소는 기억하기 어렵다.
-   IP는 변경될 수 있다.

#### DNS(Domain Name System)

-   전화번호부
-   도메인 명을 IP 주소로 변환
